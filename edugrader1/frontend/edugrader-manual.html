<!DOCTYPE html>
<html>
<head>
    <title>EduGrader –†—É—á–Ω–æ–π —Ç–µ—Å—Ç</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 800px; margin: 0 auto; background: #f0f2f5; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .info { background: #e7f3ff; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #1a73e8; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: #1a73e8; color: white; border: none; cursor: pointer; font-size: 16px; }
        button:hover { background: #1557b0; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 8px; overflow: auto; }
        .endpoint-input { background: #f0f7ff; padding: 10px; border-radius: 8px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; padding: 12px; border-radius: 8px; }
        .error { background: #f8d7da; color: #721c24; padding: 12px; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß EduGrader –†—É—á–Ω–æ–π —Ç–µ—Å—Ç API</h1>
        
        <div class="info">
            <strong>üìå –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong>
            <ol>
                <li>–û—Ç–∫—Ä–æ–π—Ç–µ <a href="http://127.0.0.1:8000/docs" target="_blank">http://127.0.0.1:8000/docs</a></li>
                <li>–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ —Ç–∞–º –µ—Å—Ç—å –ø—É—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: /api/register, /auth/register, /register)</li>
                <li>–í–≤–µ–¥–∏—Ç–µ —ç—Ç–∏ –ø—É—Ç–∏ –≤ –ø–æ–ª—è –Ω–∏–∂–µ</li>
            </ol>
        </div>

        <div class="endpoint-input">
            <h3>üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
            <label>–ü—É—Ç—å –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–∏–∑ Swagger):</label>
            <input type="text" id="registerPath" placeholder="/api/register –∏–ª–∏ /register –∏–ª–∏ /auth/register" value="/register">
            
            <input type="email" id="email" placeholder="Email" value="test@example.com">
            <input type="text" id="username" placeholder="Username" value="testuser">
            <input type="text" id="fullname" placeholder="Full Name" value="–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å">
            <input type="password" id="password" placeholder="Password" value="password123">
            <select id="role">
                <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
                <option value="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</option>
            </select>
            <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </div>

        <div class="endpoint-input">
            <h3>üîë –í—Ö–æ–¥</h3>
            <label>–ü—É—Ç—å –¥–ª—è –≤—Ö–æ–¥–∞ (–∏–∑ Swagger):</label>
            <input type="text" id="loginPath" placeholder="/api/token –∏–ª–∏ /token –∏–ª–∏ /login" value="/token">
            
            <input type="text" id="login_username" placeholder="Username" value="testuser">
            <input type="password" id="login_password" placeholder="Password" value="password123">
            <button onclick="login()">–í–æ–π—Ç–∏</button>
        </div>

        <div class="endpoint-input">
            <h3>üìã –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</h3>
            <label>–ú–µ—Ç–æ–¥:</label>
            <select id="method">
                <option value="GET">GET</option>
                <option value="POST">POST</option>
            </select>
            
            <label>–ü—É—Ç—å:</label>
            <input type="text" id="testPath" placeholder="/some/path" value="/">
            
            <label>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON, –µ—Å–ª–∏ POST):</label>
            <textarea id="testBody" rows="4" placeholder='{"key": "value"}'></textarea>
            
            <button onclick="testRequest()">–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
        </div>

        <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <pre id="result">–û–∂–∏–¥–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è...</pre>

        <h3>üì° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ</h3>
        <pre id="serverInfo"></pre>
    </div>

    <script>
        const BASE_URL = 'http://127.0.0.1:8000';

        // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π –ø—É—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        window.onload = async () => {
            try {
                const response = await fetch(BASE_URL);
                const text = await response.text();
                document.getElementById('serverInfo').textContent = 
                    `–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–π –ø—É—Ç—å (${BASE_URL}):\n${text.substring(0, 500)}...`;
            } catch (error) {
                document.getElementById('serverInfo').textContent = 
                    `–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É: ${error}`;
            }
        };

        async function register() {
            const path = document.getElementById('registerPath').value;
            const url = BASE_URL + path;
            
            const data = {
                email: document.getElementById('email').value,
                username: document.getElementById('username').value,
                full_name: document.getElementById('fullname').value,
                password: document.getElementById('password').value,
                role: document.getElementById('role').value
            };
            
            await makeRequest('POST', url, data);
        }

        async function login() {
            const path = document.getElementById('loginPath').value;
            const url = BASE_URL + path;
            
            const formData = new URLSearchParams();
            formData.append('username', document.getElementById('login_username').value);
            formData.append('password', document.getElementById('login_password').value);
            
            try {
                const resultEl = document.getElementById('result');
                resultEl.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: formData
                });
                
                const result = await response.json();
                resultEl.textContent = JSON.stringify({
                    status: response.status,
                    statusText: response.statusText,
                    url: url,
                    data: result
                }, null, 2);
                
            } catch (error) {
                document.getElementById('result').textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error;
            }
        }

        async function testRequest() {
            const method = document.getElementById('method').value;
            const path = document.getElementById('testPath').value;
            const url = BASE_URL + path;
            const body = document.getElementById('testBody').value;
            
            await makeRequest(method, url, body ? JSON.parse(body) : null);
        }

        async function makeRequest(method, url, data) {
            const resultEl = document.getElementById('result');
            resultEl.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';
            
            const options = {
                method: method,
                headers: {}
            };
            
            if (data) {
                if (method === 'POST' && url.includes('token')) {
                    options.headers['Content-Type'] = 'application/x-www-form-urlencoded';
                    options.body = new URLSearchParams(data);
                } else {
                    options.headers['Content-Type'] = 'application/json';
                    options.body = JSON.stringify(data);
                }
            }
            
            try {
                console.log('Request:', { url, options });
                
                const response = await fetch(url, options);
                
                let responseData;
                const contentType = response.headers.get('content-type');
                if (contentType && contentType.includes('application/json')) {
                    responseData = await response.json();
                } else {
                    responseData = await response.text();
                }
                
                resultEl.textContent = JSON.stringify({
                    status: response.status,
                    statusText: response.statusText,
                    url: url,
                    headers: Object.fromEntries(response.headers.entries()),
                    data: responseData
                }, null, 2);
                
            } catch (error) {
                resultEl.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error + '\n\nURL: ' + url;
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>