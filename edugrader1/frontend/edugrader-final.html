<!DOCTYPE html>
<html>
<head>
    <title>EduGrader –¢–µ—Å—Ç</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 800px; margin: 0 auto; background: #f0f2f5; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .success { background: #d4edda; color: #155724; padding: 12px; border-radius: 8px; margin: 10px 0; }
        .error { background: #f8d7da; color: #721c24; padding: 12px; border-radius: 8px; margin: 10px 0; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: #1a73e8; color: white; border: none; cursor: pointer; font-size: 16px; }
        button:hover { background: #1557b0; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 8px; overflow: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö EduGrader –¢–µ—Å—Ç API</h1>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ -->
        <div class="success" id="serverInfo">
            ‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://127.0.0.1:8000
        </div>

        <h2>üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input type="email" id="email" placeholder="Email" value="test@example.com">
        <input type="text" id="username" placeholder="Username" value="testuser">
        <input type="text" id="fullname" placeholder="Full Name" value="–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å">
        <input type="password" id="password" placeholder="Password" value="password123">
        <select id="role">
            <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
            <option value="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</option>
        </select>
        <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>

        <h2>üîë –í—Ö–æ–¥</h2>
        <input type="text" id="login_username" placeholder="Username" value="testuser">
        <input type="password" id="login_password" placeholder="Password" value="password123">
        <button onclick="login()">–í–æ–π—Ç–∏</button>

        <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
        <pre id="result">–û–∂–∏–¥–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è...</pre>
    </div>

    <script>
        // –ë–ï–ó /api –≤ –ø—É—Ç–∏ - –Ω–∞–ø—Ä—è–º—É—é –∫ –∫–æ—Ä–Ω—é —Å–µ—Ä–≤–µ—Ä–∞
        const BASE_URL = 'http://127.0.0.1:8000';

        async function register() {
            const data = {
                email: document.getElementById('email').value,
                username: document.getElementById('username').value,
                full_name: document.getElementById('fullname').value,
                password: document.getElementById('password').value,
                role: document.getElementById('role').value
            };
            
            const resultEl = document.getElementById('result');
            resultEl.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';
            
            try {
                // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                const endpoints = [
                    `${BASE_URL}/api/register`,
                    `${BASE_URL}/register`,
                    `${BASE_URL}/auth/register`,
                    `${BASE_URL}/api/auth/register`
                ];
                
                for (const url of endpoints) {
                    try {
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            resultEl.textContent = `‚úÖ –£—Å–ø–µ—à–Ω–æ (${url})\n${JSON.stringify(result, null, 2)}`;
                            return;
                        }
                    } catch (e) {
                        continue;
                    }
                }
                
                resultEl.textContent = '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
                
            } catch (error) {
                resultEl.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error;
            }
        }

        async function login() {
            const formData = new URLSearchParams();
            formData.append('username', document.getElementById('login_username').value);
            formData.append('password', document.getElementById('login_password').value);
            
            const resultEl = document.getElementById('result');
            resultEl.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';
            
            try {
                // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è –≤—Ö–æ–¥–∞
                const endpoints = [
                    `${BASE_URL}/api/token`,
                    `${BASE_URL}/token`,
                    `${BASE_URL}/auth/token`,
                    `${BASE_URL}/api/auth/token`,
                    `${BASE_URL}/login`,
                    `${BASE_URL}/api/login`
                ];
                
                for (const url of endpoints) {
                    try {
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                            body: formData
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            resultEl.textContent = `‚úÖ –£—Å–ø–µ—à–Ω–æ (${url})\n${JSON.stringify(result, null, 2)}`;
                            return;
                        }
                    } catch (e) {
                        continue;
                    }
                }
                
                resultEl.textContent = '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint –¥–ª—è –≤—Ö–æ–¥–∞';
                
            } catch (error) {
                resultEl.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + error;
            }
        }
    </script>
</body>
</html>